<!doctype html><html lang=zh-CN><head><meta name=generator content="Hugo 0.136.4"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="朴素技术博客"><title>白汤四物</title>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/fontawesome.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/solid.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/regular.min.css crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js crossorigin=anonymous></script><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/rainbow.min.css crossorigin=anonymous referrerpolicy=no-referrer><link href rel=alternate type=application/rss+xml title=白汤四物><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-3GNL63B62Q"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3GNL63B62Q")</script></head><body><nav class=nav><div class=nav-container><h1 class=nav-title><a href=/><img src=/logo.png alt=白汤四物></a></h1><ul><li><a href=/posts/><span>文章</span></a></li><li><a href=/moments/><span>动态</span></a></li><li><a href=/categories/><span>分类</span></a></li><li><a href=/tags/><span>标签</span></a></li><li><a href=/search/><span>搜索</span></a></li><li><a href=/about/><span>关于</span></a></li></ul></div></nav><div class=banner><main><blockquote><p>Ours is essentially a tragic age, so we refuse to take it tragically. The cataclysm has happened, we are among the ruins, we start to build up new little habitats, to have new little hopes. It is rather hard work: there is now no smooth road into the future: but we go round, or scramble over the obstacles. We've got to live, no matter how many skies have fallen.</p></blockquote><p align=right>― D.H. Lawrence, Lady Chatterley's Lover</p></main></div><main><div class=catalogue><div class=catalogue-item><time datetime="2023-10-07 00:00:00 +0000 UTC" class=catalogue-time>2023年10月7日</time>
<a href=/posts/lazarus-project-internationalization/ class=catalogue-title>Lazarus 项目支持多语言国际化</a><div class=catalogue-line></div><div class=catalogue-summary><p><a href=https://www.lazarus-ide.org/ target=_blank rel=noopener>Lazarus</a> 是一个与 Delphi 兼容的跨平台 RAD 集成开发环境。和 Delphi 一样， Lazarus 可以拖放组件，快速开发 GUI 应用程序。它使用 <a href=https://www.freepascal.org/ target=_blank rel=noopener>Free Pascal</a> 作为后端编译器。当前的 Lazarus 版本是 2.2.6 ，内置的 Free Pascal 编译器版本是 3.2.2 。</p><h2 id=修复-gettext-包的缺陷>修复 gettext 包的缺陷</h2><p>Free Pascal 包含 <a href="https://gitlab.com/freepascal.org/fpc/source/-/blob/fixes_3_2/packages/fcl-base/src/gettext.pp?ref_type=heads" target=_blank rel=noopener>gettext</a> 包，可以用来实现软件国际化。但是当前版本 gettext 中的 <code>GetLanguageIDs</code> 过程在 Windows 系统下存在缺陷，无法获取到符合规范的 locale 名称：</p><figure class=code><pre><span class=code-lang>PASCAL</span><code data-ln-selected data-ln-start-from=287 class=language-pascal>{$ifdef windows}
procedure GetLanguageIDs(var Lang, FallbackLang: string);
var
  Buffer: array[1..4] of {$ifdef Wince}WideChar{$else}char{$endif};
  Country: string;
  UserLCID: LCID;
begin
  //defaults
  Lang := &#39;&#39;;
  FallbackLang:=&#39;&#39;;
  UserLCID := GetUserDefaultLCID;
  if GetLocaleInfo(UserLCID, LOCALE_SABBREVLANGNAME, @Buffer[1], 4)&lt;&gt;0 then
    FallbackLang := lowercase(copy(Buffer,1,2));
  if GetLocaleInfo(UserLCID, LOCALE_SABBREVCTRYNAME, @Buffer[1], 4)&lt;&gt;0 then begin
    Country := copy(Buffer,1,2);

    // some 2 letter codes are not the first two letters of the 3 letter code
    // there are probably more, but first let us see if there are translations
    if (Buffer=&#39;PRT&#39;) then Country:=&#39;PT&#39;;

    Lang := FallbackLang&#43;&#39;_&#39;&#43;Country;
  end;
end;</code></pre><figcaption>gettext.pp</figcaption></figure><p>在简体中文的 Windows 环境中，该过程输出的 <code>Lang</code> 值是 <code>ch_CH</code> ，而不是期望的 <code>zh_CN</code> 。虽然在最新的 <a href=https://gitlab.com/freepascal.org/fpc/source target=_blank rel=noopener>FPCSource</a> 源代码中已经修复了这个问题，但事实上修复方案是有问题的：</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/Pascal/>Pascal</a></li><li>#<a href=/tags/Lazarus/>Lazarus</a></li></ul></div><div class=catalogue-item><time datetime="2023-09-19 00:00:00 +0000 UTC" class=catalogue-time>2023年9月19日</time>
<a href=/posts/auto-build-a-git-branch-by-github-actions/ class=catalogue-title>通过 GitHub Actions 自动构建分支</a><div class=catalogue-line></div><div class=catalogue-summary><p>在 <a href=https://github.com/tabris17/cuda_translation_zh_CN target=_blank rel=noopener>CudaText 汉化包项目</a>中需要实现一个 CI/CD 脚本：一是用 <code>msgfmt</code> 命令生成 MO 文件；二是将生成的汉化包发布到 main 分支上。第一步倒是很容易通过 GitHub Actions 调用 Makefile 脚本来实现，第二步纯手写的话似乎比较麻烦，不如我们先问一下神奇的 ChatGPT 吧：</p><blockquote><p><strong>fournoas</strong>: 请帮我写一个 github actions workflow 脚本，它先调用 make build 命令构建项目，并将生成的 build 目录内容发布到 main 分支</p><p><strong>ChatGPT</strong>: 您可以使用以下GitHub Actions workflow脚本来构建项目并将生成的build目录内容发布到main分支。请将以下内容添加到您的项目的<code>.github/workflows</code>目录中的一个YAML文件中，例如<code>build.yml</code>。</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags></ul></div><div class=catalogue-item><time datetime="2023-09-15 00:00:00 +0000 UTC" class=catalogue-time>2023年9月15日</time>
<a href=/posts/format-strings-for-i18n/ class=catalogue-title>如何在支持多国语言的程序中正确使用格式化字符串</a><div class=catalogue-line></div><div class=catalogue-summary><p>让程序支持多国语言也叫做国际化（ internationalization / i18n ）。几乎所有的现代软件开发框架都会提供至少一种国际化解决方案，开发人员也可以使用第三方的 i18n 库，比如 <a href=https://www.gnu.org/software/gettext/ target=_blank rel=noopener>GNU gettext</a> 等。其实现原理也很简单：开发者在编写软件时，使用某个 Native 语言书写代码内部的文本字符串，一般选择使用英语；然后将每个文本字符串都翻译成软件需要支持的其他语言；在软件运行时，每次输出文本字符串都会调用 i18n 模块的接口，模块会根据当前系统的 locale 环境将文本字符串转换成对应的语言版本，这一过程也被称为本地化（ localization / l10n ）。</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags></ul></div><div class=catalogue-item><time datetime="2023-09-14 00:00:00 +0000 UTC" class=catalogue-time>2023年9月14日</time>
<a href=/posts/text-editor-cudatext-simplified-chinese-translation-package/ class=catalogue-title>文本编辑器 CudaText 简体中文汉化包</a><div class=catalogue-line></div><div class=catalogue-summary><p>不久之前，我在 Windows 平台上最常用的文本编辑器还是 <a href=https://www.rizonesoft.com/downloads/notepad3/ target=_blank rel=noopener>Notepad3</a> 和 <a href=https://notepad-plus-plus.org/downloads/ target=_blank rel=noopener>Notepad++</a> 。前者用来替换系统自带的记事本；后者用来处理一些稍微复杂，但还没有上升到需要动用专业 IDE 的文本编辑工作。最近发现新版本的 Notepad++ 会频繁卡顿，但由于拖延症和考虑到更换新软件的适应成本，就一直没有想过要换掉它。直到前几周 <a href=https://securitylab.github.com/advisories/GHSL-2023-092_Notepad__/ target=_blank rel=noopener>Notepad++ 被爆出存在多个缓冲区溢出漏洞</a>，特别地，其中还包含了几个可以执行任意代码的高危漏洞。本来作为一个个人维护的开源项目，爆出几个漏洞来也无伤大雅。然而离谱的是，漏洞发现者早在今年四月份就向 Notepad++ 的作者报告了漏洞，但是这几个漏洞一直没有被修复。直到漏洞细节被公开的半个月后，这几个漏洞才得以修复。是时候另觅一款好用的轻量级文本编辑器了。</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags></ul></div><div class=catalogue-item><time datetime="2023-09-10 08:20:55 +0800 +0800" class=catalogue-time>2023年9月10日 08:20:55</time><p class=head><a href=/moments/202309/1694305255/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>分享《<a href=https://www.pcworld.com/article/2055125/insider-tip-this-bug-speeds-up-windows-11-file-explorer.html target=_blank rel=noopener>This weird Windows 11 bug drastically speeds up File Explorer</a>》：</span></p><div class=catalogue-moment><p>按 F11 全屏再恢复 Windows 资源管理器窗口，能显著提速。多方验证，真实可信，原因未知，非常神奇。</p></div><ul class=catalogue-tags><li>#<a href=/tags/Windows/>Windows</a></li></ul></div><div class=catalogue-item><time datetime="2023-09-08 00:00:00 +0000 UTC" class=catalogue-time>2023年9月8日</time>
<a href=/posts/prajna-paramita-hrdaya-sutra/ class=catalogue-title>般若波罗蜜多心经</a><div class=catalogue-line></div><div class=catalogue-summary><style>@font-face{font-family:思源宋体;src:url(./fonts/clipped.woff2)format("woff2"),url(./fonts/clipped.woff)format("woff"),url(./fonts/clipped.ttf)format("truetype"),url(./fonts/clipped.otf)format("opentype"),url(./fonts/clipped.eot)format("embedded-opentype")}</style><section style=align-items:center;display:flex;justify-content:center;text-align:center><p style=font-size:22px;font-family:思源宋体;writing-mode:vertical-rl>觀自在菩薩行深般若波羅蜜多時照見五蘊皆空<br>度一切苦厄舍利子色不異空空不異色色即是空<br>空即是色受想行識亦復如是舍利子是諸法空相<br>不生不滅不垢不淨不增不減是故空中無色無受<br>想行識無眼耳鼻舌身意無色聲香味觸法無眼界<br>乃至無意識界無無明亦無無明盡乃至無老死亦<br>無老死盡無苦集滅道無智亦無得以無所得故菩<br>提薩埵依般若波羅蜜多故心無罣礙無罣礙故無<br>有恐怖遠離顛倒夢想究竟涅槃三世諸佛依般若<br>波羅蜜多故得阿耨多羅三藐三菩提故知般若波<br>羅蜜多是大神咒是大明咒是無上咒是無等等咒<br>能除一切苦真實不虛故說般若波羅蜜多咒即說<br>咒曰揭諦揭諦波羅揭諦波羅僧揭諦菩提薩婆訶</p></section><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/%E4%BD%9B%E6%95%99/>佛教</a></li></ul></div><div class=catalogue-item><time datetime="2023-09-07 00:00:00 +0000 UTC" class=catalogue-time>2023年9月7日</time>
<a href=/posts/implement-xdg-open-by-rundll32.exe-command/ class=catalogue-title>用 RunDLL32.exe 命令实现 xdg-open</a><div class=catalogue-line></div><div class=catalogue-summary><p><code>xdg-open</code> 是 Linux 下的一个命令，可以调用对应的程序来打开目标文件，等同于在文件管理器中双击打开该文件。Ubuntu 用户可以通过执行 <code>sudo apt install xdg-utils -y</code> 来安装 <code>xdg-open</code> 命令，这个命令的用法也很简单：</p><pre><code class=language-text>xdg-open { file | URL }</code></pre><p>遗憾的是， Windows 系统并没用提供类似的命令，不过我们可以通过 Windows 自带的 rundll32.exe 命令来实现一个类似功能的脚本。</p><p>RunDLL32.exe 用来加载指定的 DLL 文件并调用指定的导出函数。用法如下：</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/Windows/>Windows</a></li></ul></div><div class=catalogue-item><time datetime="2023-09-06 11:55:35 +0800 +0800" class=catalogue-time>2023年9月6日 11:55:35</time><p class=head><a href=/moments/202309/1693972535/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>说：</span></p><div class=catalogue-moment><div class=images><div class="box img-preview" data-src=/moments/202309/1693972535/01.jpg style=background-image:url(/moments/202309/1693972535/01.jpg)></div></div></div></div><div class=catalogue-item><time datetime="2023-08-30 13:47:15 +0800 +0800" class=catalogue-time>2023年8月30日 13:47:15</time><p class=head><a href=/moments/202308/1693374435/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>说：</span></p><div class=catalogue-moment><p>问：既然中芯国际是爱国芯，为什么他们要选择在开曼群岛注册啊？</p><p>答：因为「离岸爱国」呀。</p></div><ul class=catalogue-tags><li>#<a href=/tags/Radio-Yerevan/>Radio Yerevan</a></li></ul></div><div class=catalogue-item><time datetime="2023-08-26 00:08:59 +0800 +0800" class=catalogue-time>2023年8月26日 00:08:59</time><p class=head><a href=/moments/202308/1692979739/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>评论《<a href=https://m.163.com/dy/article/HS38IE8O0553MZKE.html target=_blank rel=noopener>危害不亚于切尔诺贝利的苏联核事故：克什特姆核废料爆炸</a>》：</span></p><div class=catalogue-moment><p>每当你看到新闻感觉目前情况极度糟糕的时候，就去翻一下苏联的黑历史，你就会发现现在的状况远没有达到历史上的下限。</p><p>苏联失事的K-278核潜艇还静静地躺在挪威附近的海底，周围放射性铯同位素水平超正常值80万倍。但愿诸位这辈子都没有吃过挪威三文鱼🙏</p></div></div></div><div class=pagination><a href=/page/4/ class="left arrow">上一页</a>
<a href=/page/6/ class="right arrow">下一页</a>
<span><sup>5</sup> &frasl; <sub>40</sub></span></div></main><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/highlight.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/scala.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/nim.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/powershell.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/nginx.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/delphi.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/dos.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/haxe.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://unpkg.com/highlightjs-svelte/dist/svelte.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=/js/code.js></script><script>hljs.highlightAll(),hljs.initLineNumbersOnLoad(),hljs.initSelectLines()</script><footer><span>&copy; <time datetime="2024-10-23 07:56:47.223514132 +0000 UTC m=+0.195342811">2024</time> fournoas.com. Powered by <a href=https://gohugo.io>Hugo</a>.</span></footer></body></html>