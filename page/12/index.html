<!doctype html><html lang=zh-CN><head><meta name=generator content="Hugo 0.136.4"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="朴素技术博客"><title>白汤四物</title>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/fontawesome.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/solid.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/regular.min.css crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js crossorigin=anonymous></script><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/rainbow.min.css crossorigin=anonymous referrerpolicy=no-referrer><link href rel=alternate type=application/rss+xml title=白汤四物><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-3GNL63B62Q"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3GNL63B62Q")</script></head><body><nav class=nav><div class=nav-container><h1 class=nav-title><a href=/><img src=/logo.png alt=白汤四物></a></h1><ul><li><a href=/posts/><span>文章</span></a></li><li><a href=/moments/><span>动态</span></a></li><li><a href=/categories/><span>分类</span></a></li><li><a href=/tags/><span>标签</span></a></li><li><a href=/search/><span>搜索</span></a></li><li><a href=/about/><span>关于</span></a></li></ul></div></nav><div class=banner><main><blockquote><p>Ours is essentially a tragic age, so we refuse to take it tragically. The cataclysm has happened, we are among the ruins, we start to build up new little habitats, to have new little hopes. It is rather hard work: there is now no smooth road into the future: but we go round, or scramble over the obstacles. We've got to live, no matter how many skies have fallen.</p></blockquote><p align=right>― D.H. Lawrence, Lady Chatterley's Lover</p></main></div><main><div class=catalogue><div class=catalogue-item><time datetime="2022-11-07 00:00:00 +0000 UTC" class=catalogue-time>2022年11月7日</time>
<a href=/posts/chinese-web-typesetting-design-suggestions/ class=catalogue-title>中文网页排版设计建议</a><div class=catalogue-line></div><div class=catalogue-summary><h2 id=使用哪种引号>使用哪种引号</h2><p>在《<a href=http://www.moe.gov.cn/ewebeditor/uploadfile/2015/01/13/20150113091548267.pdf target=_blank rel=noopener>标点符号用法</a>》（ GB/T 15834—2011 ）中规定的双引号和单引号分别为 <code>“”</code> 和 <code>‘’</code>，这组引号起源于西文，且称作国标引号。另外，在《<a href=https://language.moe.gov.tw/001/upload/files/site_content/m0001/hau/Revised_Handbook_of_Punctuation.pdf target=_blank rel=noopener>重订标点符号手册</a>》中规定的双引号和单引号（横式）分别为 <code>『』</code> 和 <code>「」</code>，这组引号又被称为直角引号。</p><p>需要注意的是，国标引号和直角引号的单引号、双引号使用方式是相反的：国标引号，外层使用双引号，内层嵌套使用单引号；直角引号，外层使用单引号，内层嵌套使用双引号。例如：</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/%E5%89%8D%E7%AB%AF/>前端</a></li></ul></div><div class=catalogue-item><time datetime="2022-10-31 00:00:00 +0000 UTC" class=catalogue-time>2022年10月31日</time>
<a href=/posts/handling-signal-in-python-on-different-platforms/ class=catalogue-title>Python 信号处理在不同平台上的差异</a><div class=catalogue-line></div><div class=catalogue-summary><p>在前文《<a href=/posts/why-does-ctrl-c-not-kill-python-process-in-windows-console/>为何 Windows 下无法用 Ctrl+C 终止 Python 进程</a>》中，虽然解释了产生该现象的原因，但却没有解释为何同样的代码在 Linux 下就可以用 Ctrl+C 来中止。究其原因，是由于在操作系统层面，Linux 和 Windows 对 SIGINT 的信号处理方式不同所导致的。</p><h2 id=python-的底层实现原理>Python 的底层实现原理</h2><p>Python 将操作系统或 C 标准库提供的信号处理器称作 Low-level signal handler，Python 内建的 signal 模块在其基础上进行了封装。在 <a href=https://github.com/python/cpython/blob/05e48865be69e1e5824f6915b588ff054717bb42/Python/pylifecycle.c#L3045 target=_blank rel=noopener>Python/pylifecycle.c</a> 文件中找到 <code>PyOS_setsig()</code> 函数：</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/Python/>Python</a></li></ul></div><div class=catalogue-item><time datetime="2022-10-31 00:00:00 +0000 UTC" class=catalogue-time>2022年10月31日</time>
<a href=/posts/python-signal-handlers-and-reentrant-call-runtime-error-of-print-function/ class=catalogue-title>Python 的 signal 处理与 print() 的 reentrant call 运行时错误</a><div class=catalogue-line></div><div class=catalogue-summary><p>在前文《<a href=../why-does-ctrl-c-not-kill-python-process-in-windows-console/>为何 Windows 下无法用 Ctrl+C 终止 Python 进程</a>》中，讲解了 Python 信号处理的基本原理。当时为了撰写文章而编写了一些测试代码，在运行某例测试代码时，发生了奇怪的 reentrant call 运行时错误。代码如下：</p><pre><span class=code-lang>PYTHON</span><code class=language-python>import signal

signal.signal(signal.SIGINT, lambda signum, frame: print(&#39;test&#39;))
while True: print(&#39;test&#39;)</code></pre><p>在程序运行中按下 Ctrl+C，程序抛出 RuntimeError 异常。完整错误信息如下：</p><pre><code class=language-text>Traceback (most recent call last):
  File &#34;test.py&#34;, line 4, in &lt;module&gt;
    while True: print(&#39;test&#39;)
                ^^^^^^^^^^^^^
  File &#34;test.py&#34;, line 3, in &lt;lambda&gt;
    signal.signal(signal.SIGINT, lambda signum, frame: print(&#39;test&#39;))
                                                       ^^^^^^^^^^^^^
RuntimeError: reentrant call inside &lt;_io.BufferedWriter name=&#39;&lt;stdout&gt;&#39;&gt;</code></pre><p>错误信息中所提到的 reentrant call 是一个计算机术语，它的意思是程序或者子例程（subroutine）在执行过程中被中断，此时再次调用该程序或者子例程。由于 Python 的信号处理器是运行在主线程中，所以不存在多线程冲突的可能。因此，猜想错误可能是由如下的代码引起的：</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/Python/>Python</a></li></ul></div><div class=catalogue-item><time datetime="2022-10-30 21:22:06 +0800 +0800" class=catalogue-time>2022年10月30日 21:22:06</time><p class=head><a href=/moments/202210/1667136126/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>说：</span></p><div class=catalogue-moment><p>问：哪个小学生不但拥有大学学历，还成为了国家元首？</p><p>答：比卡星大总统——帕比</p><div class=images><div class="box img-preview" data-src=/moments/202210/1667136126/01.jpeg style=background-image:url(/moments/202210/1667136126/01.jpeg)></div></div></div><ul class=catalogue-tags><li>#<a href=/tags/Radio-Yerevan/>Radio Yerevan</a></li></ul></div><div class=catalogue-item><time datetime="2022-10-28 00:00:00 +0000 UTC" class=catalogue-time>2022年10月28日</time>
<a href=/posts/why-does-ctrl-c-not-kill-python-process-in-windows-console/ class=catalogue-title>为何 Windows 下无法用 Ctrl+C 终止 Python 进程</a><div class=catalogue-line></div><div class=catalogue-summary><p>在 Windows 命令行中按下 <code>Ctrl+C</code> 或者 <code>Ctrl+Break</code> 可以结束当前正在执行的命令。通常情况下，这个方法同样适用于 Python 的控制台进程。特别地，Python 内置了一个 <code>KeyboardInterrupt</code> 异常专门用于捕获按下 <code>Ctrl+C</code> 而触发的程序退出：</p><pre><span class=code-lang>PYTHON</span><code class=language-python>try:
    while True:
        print(&#39;running...&#39;)
except KeyboardInterrupt:
    print(&#39;keyboard interrupt received&#39;)
    # 退出前清理现场，释放资源</code></pre><p>Python 触发 <code>KeyboardInterrupt</code> 异常的底层实现原理依赖于 signal 机制<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。使用信号处理器也可以捕获按下 <code>Ctrl+C</code> 而触发的程序退出：</p><pre><span class=code-lang>PYTHON</span><code class=language-python>import signal

def signal_handler(signum, frame):
    raise KeyboardInterrupt

signal.signal(signal.SIGINT, signal_handler)

try:
    while True:
        print(&#39;running...&#39;)
except KeyboardInterrupt:
    print(&#39;keyboard interrupt received&#39;)
    # 退出前清理现场，释放资源</code></pre><p>但是在某些情况下，Windows 的 Python 命令行程序无法用 <code>Ctrl+C</code> 或者 <code>Ctrl+Break</code> 终止。比如在 <a href=https://bugs.python.org/issue41437 target=_blank rel=noopener>issue 41437: SIGINT blocked by socket operations like recv on Windows</a> 中提到：在 Windows 中，当 <code>socket.recv()</code> 操作阻塞时，无法响应 <code>SIGINT</code>。类似的，当 <code>thread.join()</code> 操作阻塞时，也无法用 <code>Ctrl+C</code> 终止。例如下面代码在 Windows 下运行就无法使用 <code>Ctrl+C</code> 来退出：</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/Python/>Python</a></li></ul></div><div class=catalogue-item><time datetime="2022-10-25 13:08:14 +0800 +0800" class=catalogue-time>2022年10月25日 13:08:14</time><p class=head><a href=/moments/202210/1666674494/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>评论《<a href=https://book.douban.com/subject/1418776/ target=_blank rel=noopener>美国反对美国</a>》：</span></p><div class=catalogue-moment><p>这不巧了么，昭和十六年的日本人也是这样想的。</p><blockquote><p>美国同日本比，东方文化就占了上风。<br>美国的体制，总体来说建筑在个人主义、享乐主义和民主主义的基础上，但它正明显地输给一个集体主义、忘我主义和权威主义的体制。</p></blockquote><div class=images><div class="box img-preview" data-src=/moments/202210/1666674494/01.jpg style=background-image:url(/moments/202210/1666674494/01.jpg)></div></div></div></div><div class=catalogue-item><time datetime="2022-10-25 00:00:00 +0000 UTC" class=catalogue-time>2022年10月25日</time>
<a href=/posts/vboxmanage-command-line-tool-for-virtualbox/ class=catalogue-title>VirtualBox 命令行管理工具——VBoxManage</a><div class=catalogue-line></div><div class=catalogue-summary><p>VBoxManage 是 Oracle VM VirtualBox 的命令行管理工具。在 Windows 系统中，软件默认安装在 <code>C:\Program Files\Oracle\VirtualBox</code> 目录下。运行该命令前，可以将命令行的当前路径切换到软件安装路径：</p><pre><span class=code-lang>POWERSHELL</span><code class=language-powershell>cd &#34;C:\Program Files\Oracle\VirtualBox&#34;</code></pre><h2 id=显示所有已安装的虚拟机>显示所有已安装的虚拟机</h2><pre><span class=code-lang>POWERSHELL</span><code class=language-powershell>.\VBoxManage list vms</code></pre><p>结果如下：</p><pre><code class=language-text>&#34;Ubuntu&#34; {e16b273d-58e1-4274-8e89-f4ad5e1e3778}
&#34;FreeBSD&#34; {91bda7b4-dce2-4174-879c-e71858db3fe5}
&#34;SmartOS&#34; {279f20a0-839c-476c-b7f9-b5a40ee30eec}</code></pre><h2 id=移动虚拟机到其他路径>移动虚拟机到其他路径</h2><p>VirtualBox 的虚拟机默认安装在 <code>C:\Users\&lt;Username>\VirtualBox VMs</code> 路径下，会占用很大的硬盘空间。通过下面命令可以将虚拟机数据移动到其他路径：</p><pre><span class=code-lang>POWERSHELL</span><code class=language-powershell>.\VBoxManage.exe movevm ubuntu --folder &#34;D:\Data\VirtualBox VMs&#34;</code></pre><h2 id=打开启用嵌套-vt-xamd-v开关>打开「启用嵌套 VT-x/AMD-V」开关</h2><p>此开关在「设置-系统-处理器」选项卡中，默认置灰不可用。可以通过以下命令开启：</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags></ul></div><div class=catalogue-item><time datetime="2022-10-22 17:24:08 +0800 +0800" class=catalogue-time>2022年10月22日 17:24:08</time><p class=head><a href=/moments/202210/1666430648/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>说：</span></p><div class=catalogue-moment><p>它搀你离开，千里之外，你无声黑白。<br>沉默年代，浓雾散不开，看不清对白。<br>会议被安排，演一场意外，你悄然走开。<br>它何时死难猜，用一生去等待！</p></div></div><div class=catalogue-item><time datetime="2022-10-20 00:00:00 +0000 UTC" class=catalogue-time>2022年10月20日</time>
<a href=/posts/monte-carlo-simulation-of-a-middle-school-math-olympiad-problem/ class=catalogue-title>一道初中奥数题的蒙特卡洛解法</a><div class=catalogue-line></div><div class=catalogue-summary><figure><img src=/posts/monte-carlo-simulation-of-a-middle-school-math-olympiad-problem/problem.jpg alt=四只鸭子在一个圆形水池中随机游动。某一时刻，四只鸭子在同一半圆内的概率是多少？><figcaption><p>四只鸭子在一个圆形水池中随机游动。某一时刻，四只鸭子在同一半圆内的概率是多少？</p></figcaption></figure><p>这个问题必须隐含一个前提：当水池被分为两半后，任意一只鸭子，要么属于这一边，要么属于另一边，不存在同时属于两边或不属于任何一边的情况。可以把鸭子视作质点，如果鸭子正好落在分割线上，则认为此鸭子属于顺时针方向的一侧。</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/%E7%AE%97%E6%B3%95/>算法</a></li><li>#<a href=/tags/Python/>Python</a></li></ul></div><div class=catalogue-item><time datetime="2022-10-18 00:00:00 +0000 UTC" class=catalogue-time>2022年10月18日</time>
<a href=/posts/adding-full-text-search-to-a-hugo-static-website/ class=catalogue-title>为 Hugo 静态网站添加全文检索功能</a><div class=catalogue-line></div><div class=catalogue-summary><p><a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 是一种使用 Go 语言编写的静态网站构建工具。在其官网文章《<a href=https://gohugo.io/tools/search/ target=_blank rel=noopener>Search for your Hugo Website</a>》中，介绍几种为静态网站添加全文检索功能的方法。本文采用 <a href=https://pagefind.app/ target=_blank rel=noopener>Pagefind</a> 为纯静态网站实现全文检索功能。</p><p>Pagefind 是一个独立的命令行工具，可以通过 <code>npm install pagefind</code> 来安装。其原理是：运行 Pagefind 命令，扫描所有静态网页并生成索引；用户搜索时，通过网页中内嵌的 JavaScript 脚本来访问预先生成的索引，从而实现静态全文检索。</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/Hugo/>Hugo</a></li></ul></div></div><div class=pagination><a href=/page/11/ class="left arrow">上一页</a>
<a href=/page/13/ class="right arrow">下一页</a>
<span><sup>12</sup> &frasl; <sub>40</sub></span></div></main><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/highlight.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/scala.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/nim.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/powershell.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/nginx.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/delphi.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/dos.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/haxe.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://unpkg.com/highlightjs-svelte/dist/svelte.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=/js/code.js></script><script>hljs.highlightAll(),hljs.initLineNumbersOnLoad(),hljs.initSelectLines()</script><footer><span>&copy; <time datetime="2024-10-23 06:09:28.090294718 +0000 UTC m=+0.284349689">2024</time> fournoas.com. Powered by <a href=https://gohugo.io>Hugo</a>.</span></footer></body></html>