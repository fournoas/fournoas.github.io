<!doctype html><html lang=zh-CN><head><meta name=generator content="Hugo 0.134.3"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="朴素技术博客"><title>白汤四物</title>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/fontawesome.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/solid.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/regular.min.css crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js crossorigin=anonymous></script><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/rainbow.min.css crossorigin=anonymous referrerpolicy=no-referrer><link href rel=alternate type=application/rss+xml title=白汤四物><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-3GNL63B62Q"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3GNL63B62Q")</script></head><body><nav class=nav><div class=nav-container><h1 class=nav-title><a href=/><img src=/logo.png alt=白汤四物></a></h1><ul><li><a href=/posts/><span>文章</span></a></li><li><a href=/moments/><span>动态</span></a></li><li><a href=/categories/><span>分类</span></a></li><li><a href=/tags/><span>标签</span></a></li><li><a href=/search/><span>搜索</span></a></li><li><a href=/about/><span>关于</span></a></li></ul></div></nav><div class=banner><main><blockquote><p>Ours is essentially a tragic age, so we refuse to take it tragically. The cataclysm has happened, we are among the ruins, we start to build up new little habitats, to have new little hopes. It is rather hard work: there is now no smooth road into the future: but we go round, or scramble over the obstacles. We've got to live, no matter how many skies have fallen.</p></blockquote><p align=right>― D.H. Lawrence, Lady Chatterley's Lover</p></main></div><main><div class=catalogue><div class=catalogue-item><time datetime="2023-12-21 10:35:36 +0800 +0800" class=catalogue-time>2023年12月21日 10:35:36</time><p class=head><a href=https://www.fournoas.com/moments/202312/1703126136/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>说：</span></p><div class=catalogue-moment><p>很多人在表达时喜欢使用类比，这是因为它们缺乏具体分析事务的能力，只能用类比的方式来简化这一过程（当然，也有对受众认知水平的考量）。事实上，大多数类比用例都属于“类比失当”，是一种“抖机灵”。</p></div></div><div class=catalogue-item><time datetime="2023-11-08 19:05:23 +0800 +0800" class=catalogue-time>2023年11月8日 19:05:23</time><p class=head><a href=https://www.fournoas.com/moments/202311/1699441523/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>说：</span></p><div class=catalogue-moment><p>此题无解。因为无法确定司机是不是在开倒车。</p><div class=images><div class="box img-preview" data-src=https://www.fournoas.com/moments/202311/1699441523/01.png style=background-image:url(https://www.fournoas.com/moments/202311/1699441523/01.png)></div></div></div></div><div class=catalogue-item><time datetime="2023-10-27 11:01:49 +0800 +0800" class=catalogue-time>2023年10月27日 11:01:49</time><p class=head><a href=https://www.fournoas.com/moments/202310/1698375709/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>说《<a href="https://www.youtube.com/watch?v=e5CnGL4GQno" target=_blank rel=noopener>总有一天等到你</a>》：</span></p><div class=catalogue-moment><p>下面，为大家献上一曲张学友的歌，总有一天<del>轮</del>等到你</p></div></div><div class=catalogue-item><time datetime="2023-10-19 15:18:56 +0800 +0800" class=catalogue-time>2023年10月19日 15:18:56</time><p class=head><a href=https://www.fournoas.com/moments/202310/1697699936/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>评论《<a href=https://www.zhihu.com/question/24055334 target=_blank rel=noopener>为什么说崇祯帝缺乏帝王教育，什么可以称为帝王教育？</a>》：</span></p><div class=catalogue-moment><p>没想到崇祯的文化程度这么低</p></div></div><div class=catalogue-item><time datetime="2023-10-13 14:09:29 +0800 +0800" class=catalogue-time>2023年10月13日 14:09:29</time><p class=head><a href=https://www.fournoas.com/moments/202310/1697177369/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>评论电影《<a href=https://movie.douban.com/subject/1433579/ target=_blank rel=noopener>巴山夜雨</a>》：</span></p><div class=catalogue-moment><p>电影讲述一个小粉红的觉醒。但正如史塔西博物馆馆长对《窃听风暴》的评论一样：在史塔西几十年的历史中，像“维斯莱尔”那样良心发现的秘密警察，“对不起，一个都没有。”</p></div></div><div class=catalogue-item><time datetime="2023-10-13 11:57:16 +0800 +0800" class=catalogue-time>2023年10月13日 11:57:16</time><p class=head><a href=https://www.fournoas.com/moments/202310/1697169436/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>说：</span></p><div class=catalogue-moment><p>1973年7月4日，毛泽东指出：“尊孔反法，国民党也是一样啊！林彪也是啊！”9月，毛泽东在会见外宾时说：“秦始皇是中国封建社会第一个有名的皇帝，我也是秦始皇，林彪骂我是秦始皇。中国历来分两派，一派讲秦始皇好，一派讲秦始皇坏。我赞成秦始皇，不赞成孔夫子。”</p><div class=images><div class="box img-preview" data-src=https://www.fournoas.com/moments/202310/1697169436/01.jpg style=background-image:url(https://www.fournoas.com/moments/202310/1697169436/01.jpg)></div></div></div><ul class=catalogue-tags><li>#<a href=/tags/%E5%AD%A6%E5%9B%9B%E5%8F%B2%E5%AE%88%E5%88%9D%E5%BF%83/>学四史守初心</a></li></ul></div><div class=catalogue-item><time datetime="2023-10-13 11:39:27 +0800 +0800" class=catalogue-time>2023年10月13日 11:39:27</time><p class=head><a href=https://www.fournoas.com/moments/202310/1697168367/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>说：</span></p><div class=catalogue-moment><p>谁又能想到，那帮在自己同胞被强拆时连屁都不敢放一个的人，会关心起万里之外的巴勒斯坦人是否失去了家园。</p></div></div><div class=catalogue-item><time datetime="2023-10-08 08:17:53 +0800 +0800" class=catalogue-time>2023年10月8日 08:17:53</time><p class=head><a href=https://www.fournoas.com/moments/202310/1696724273/ style=float:right><span class="fa-solid fa-arrow-up-right-from-square"></span></a>
<span class=author>Fournoas
</span><span class=action>说：</span></p><div class=catalogue-moment><p>问：什么是「人类命运共同体」？</p><p>答：就是「我要是倒霉了，大家都别想好过」。</p></div><ul class=catalogue-tags><li>#<a href=/tags/Radio-Yerevan/>Radio Yerevan</a></li></ul></div><div class=catalogue-item><time datetime="2023-10-07 00:00:00 +0000 UTC" class=catalogue-time>2023年10月7日</time>
<a href=https://www.fournoas.com/posts/lazarus-project-internationalization/ class=catalogue-title>Lazarus 项目支持多语言国际化</a><div class=catalogue-line></div><p><p><a href=https://www.lazarus-ide.org/ target=_blank rel=noopener>Lazarus</a> 是一个与 Delphi 兼容的跨平台 RAD 集成开发环境。和 Delphi 一样， Lazarus 可以拖放组件，快速开发 GUI 应用程序。它使用 <a href=https://www.freepascal.org/ target=_blank rel=noopener>Free Pascal</a> 作为后端编译器。当前的 Lazarus 版本是 2.2.6 ，内置的 Free Pascal 编译器版本是 3.2.2 。</p><h2 id=修复-gettext-包的缺陷>修复 gettext 包的缺陷</h2><p>Free Pascal 包含 <a href="https://gitlab.com/freepascal.org/fpc/source/-/blob/fixes_3_2/packages/fcl-base/src/gettext.pp?ref_type=heads" target=_blank rel=noopener>gettext</a> 包，可以用来实现软件国际化。但是当前版本 gettext 中的 <code>GetLanguageIDs</code> 过程在 Windows 系统下存在缺陷，无法获取到符合规范的 locale 名称：</p><figure class=code><pre><span class=code-lang>PASCAL</span><code data-ln-selected data-ln-start-from=287 class=language-pascal>{$ifdef windows}
procedure GetLanguageIDs(var Lang, FallbackLang: string);
var
  Buffer: array[1..4] of {$ifdef Wince}WideChar{$else}char{$endif};
  Country: string;
  UserLCID: LCID;
begin
  //defaults
  Lang := &#39;&#39;;
  FallbackLang:=&#39;&#39;;
  UserLCID := GetUserDefaultLCID;
  if GetLocaleInfo(UserLCID, LOCALE_SABBREVLANGNAME, @Buffer[1], 4)&lt;&gt;0 then
    FallbackLang := lowercase(copy(Buffer,1,2));
  if GetLocaleInfo(UserLCID, LOCALE_SABBREVCTRYNAME, @Buffer[1], 4)&lt;&gt;0 then begin
    Country := copy(Buffer,1,2);

    // some 2 letter codes are not the first two letters of the 3 letter code
    // there are probably more, but first let us see if there are translations
    if (Buffer=&#39;PRT&#39;) then Country:=&#39;PT&#39;;

    Lang := FallbackLang&#43;&#39;_&#39;&#43;Country;
  end;
end;</code></pre><figcaption>gettext.pp</figcaption></figure><p>在简体中文的 Windows 环境中，该过程输出的 <code>Lang</code> 值是 <code>ch_CH</code> ，而不是期望的 <code>zh_CN</code> 。虽然在最新的 <a href=https://gitlab.com/freepascal.org/fpc/source target=_blank rel=noopener>FPCSource</a> 源代码中已经修复了这个问题，但事实上修复方案是有问题的：</p>&mldr;&mldr;</p><ul class=catalogue-tags><li>#<a href=/tags/Pascal/>Pascal</a></li><li>#<a href=/tags/Lazarus/>Lazarus</a></li></ul></div><div class=catalogue-item><time datetime="2023-09-19 00:00:00 +0000 UTC" class=catalogue-time>2023年9月19日</time>
<a href=https://www.fournoas.com/posts/auto-build-a-git-branch-by-github-actions/ class=catalogue-title>通过 GitHub Actions 自动构建分支</a><div class=catalogue-line></div><p><p>在 <a href=https://github.com/tabris17/cuda_translation_zh_CN target=_blank rel=noopener>CudaText 汉化包项目</a>中需要实现一个 CI/CD 脚本：一是用 <code>msgfmt</code> 命令生成 MO 文件；二是将生成的汉化包发布到 main 分支上。第一步倒是很容易通过 GitHub Actions 调用 Makefile 脚本来实现，第二步纯手写的话似乎比较麻烦，不如我们先问一下神奇的 ChatGPT 吧：</p><blockquote><p><strong>fournoas</strong>: 请帮我写一个 github actions workflow 脚本，它先调用 make build 命令构建项目，并将生成的 build 目录内容发布到 main 分支</p><p><strong>ChatGPT</strong>: 您可以使用以下GitHub Actions workflow脚本来构建项目并将生成的build目录内容发布到main分支。请将以下内容添加到您的项目的<code>.github/workflows</code>目录中的一个YAML文件中，例如<code>build.yml</code>。</p>&mldr;&mldr;</p><ul class=catalogue-tags></ul></div></div><div class=pagination><a href=/page/3/ class="left arrow">上一页</a>
<a href=/page/5/ class="right arrow">下一页</a>
<span><sup>4</sup> &frasl; <sub>40</sub></span></div></main><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/highlight.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/scala.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/nim.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/powershell.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/nginx.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/delphi.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/dos.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/haxe.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://unpkg.com/highlightjs-svelte/dist/svelte.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=/js/code.js></script><script>hljs.highlightAll(),hljs.initLineNumbersOnLoad(),hljs.initSelectLines()</script><footer><span>&copy; <time datetime="2024-09-26 01:46:01.591220618 +0000 UTC m=+0.179766420">2024</time> fournoas.com. Powered by <a href=https://gohugo.io>Hugo</a>.</span></footer></body></html>