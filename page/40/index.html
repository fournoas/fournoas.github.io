<!doctype html><html lang=zh-CN><head><meta name=generator content="Hugo 0.138.0"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="朴素技术博客"><title>白汤四物</title>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/fontawesome.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/solid.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/regular.min.css crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js crossorigin=anonymous></script><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/rainbow.min.css crossorigin=anonymous referrerpolicy=no-referrer><link href rel=alternate type=application/rss+xml title=白汤四物><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-3GNL63B62Q"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3GNL63B62Q")</script></head><body><nav class=nav><div class=nav-container><h1 class=nav-title><a href=/><img src=/logo.png alt=白汤四物></a></h1><ul><li><a href=/posts/><span>文章</span></a></li><li><a href=/moments/><span>动态</span></a></li><li><a href=/categories/><span>分类</span></a></li><li><a href=/tags/><span>标签</span></a></li><li><a href=/search/><span>搜索</span></a></li><li><a href=/about/><span>关于</span></a></li></ul></div></nav><div class=banner><main><blockquote><p>Ours is essentially a tragic age, so we refuse to take it tragically. The cataclysm has happened, we are among the ruins, we start to build up new little habitats, to have new little hopes. It is rather hard work: there is now no smooth road into the future: but we go round, or scramble over the obstacles. We've got to live, no matter how many skies have fallen.</p></blockquote><p align=right>― D.H. Lawrence, Lady Chatterley's Lover</p></main></div><main><div class=catalogue><div class=catalogue-item><time datetime="2015-06-25 00:00:00 +0000 UTC" class=catalogue-time>2015年6月25日</time>
<a href=/posts/data-structure-alignment-in-lua-source-code/ class=catalogue-title>Lua 源代码中的字节对齐</a><div class=catalogue-line></div><div class=catalogue-summary><p>Lua 源码中定义了一个叫 <code>L_Umaxalign</code> 的数据类型：</p><pre><span class=code-lang>c</span><code class=language-c>typedef union { 
  double u; 
  void *s; 
  lua_Integer i; 
  long l; 
} L_Umaxalign;</code></pre><p>这个结构其实是该平台上最长的数据类型。然后和 <code>TString</code> 和 <code>Udata</code> 结构定义成一个联合体：</p><pre><span class=code-lang>c</span><code class=language-c>typedef union UTString {
  L_Umaxalign dummy;  /* ensures maximum alignment for strings */
  TString tsv;
} UTString;

typedef union UUdata {
  L_Umaxalign dummy;  /* ensures maximum alignment for &#39;local&#39; udata */
  Udata uv;
} UUdata;</code></pre><p>之所以这样处理是因为 <code>TString</code> 和 <code>Udata</code> 其实是一块连续内存区域的头部，后面紧跟实体数据。为了保证访问实体数据时候字节对齐，必须让实体数的起始地址是平台最大数据长度的整数倍。好比 <code>malloc</code> 返回的地址在32位平台上是8的整数倍，在64位平台上是16的整数倍一样。</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/Lua/>Lua</a></li></ul></div><div class=catalogue-item><time datetime="2015-05-31 00:00:00 +0000 UTC" class=catalogue-time>2015年5月31日</time>
<a href=/posts/scallion-pancake/ class=catalogue-title>葱油饼</a><div class=catalogue-line></div><div class=catalogue-summary><p>制作了三次葱油饼，累积了一些心得体会，特此记录。</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags></ul></div><div class=catalogue-item><time datetime="2014-07-16 00:00:00 +0000 UTC" class=catalogue-time>2014年7月16日</time>
<a href=/posts/Rom%C3%A9o-et-Juliette-script/ class=catalogue-title>音乐剧《罗密欧与朱丽叶》中文歌词</a><div class=catalogue-line></div><div class=catalogue-summary><h2 id=第一幕>第一幕</h2><h3 id=02维罗纳>02．维罗纳</h3><p>王子：<br>你们认为自己什么都见过<br>你们游历天下，包揽群书<br>没有什么能让你们吃惊<br>欢迎来到维罗纳</p><p>你们认为人是善良的<br>因为他能写出美妙的歌<br>如果你觉得这一首歌很优美<br>欢迎来到维罗纳</p><p>当然，这里同别处一样<br>人们并不更坏，也并不更好<br>嗨！你们今夜来到我们这里<br>要么是个错误，要么纯属偶然</p><p>（副歌：）<br>你们来到了维罗纳，美丽的维罗纳<br>这座城市的居民相互厌恶<br>人们想离开，却留了下来<br>这里不是国王钟爱的地方<br>这里有两个家族称王称霸<br>你不需要选择自己的立场<br>人们早就替你作出了选择<br>你们来到了维罗纳，我们谈论的是维罗纳<br>仇恨象毒液在我们的生命中流淌<br>就象我们的血液一样<br>我们的花园同样四季芬芳<br>我们的女子同样美丽大方<br>这里的景色象人间天堂<br>但我们灵魂却在地狱里徜徉<br>你们来到了维罗纳</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/%E9%9F%B3%E4%B9%90%E5%89%A7/>音乐剧</a></li></ul></div><div class=catalogue-item><time datetime="2013-06-04 00:00:00 +0000 UTC" class=catalogue-time>2013年6月4日</time>
<a href=/posts/service-locator-and-dependency-injection-in-php/ class=catalogue-title>PHP 中的服务定位和依赖注入</a><div class=catalogue-line></div><div class=catalogue-summary><p>尝试了很多PHP框架，有轻量级的，也有企业级的，发现解耦都做得很不好，自由度都很差。Zend framework2.0 做得还不错，就是封装太多，不够轻量。</p><h2 id=一创建对象>一、创建对象</h2><p>从最原始的new操作符，到abstract factory或builder等经典创建模式，都不能满足人民群众日益高涨的解耦需求。后来，MF创造了控制反转（IoC）/依赖注入（DI）理论，提供了一个完美的解耦方案。听说一个叫"春"的JAVA框架实现了完美的IoC容器，不过我也没接触过，不太了解。</p><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/PHP/>PHP</a></li></ul></div><div class=catalogue-item><time datetime="2012-03-14 00:00:00 +0000 UTC" class=catalogue-time>2012年3月14日</time>
<a href=/posts/the-giving-plague/ class=catalogue-title>赐予的瘟疫</a><div class=catalogue-line></div><div class=catalogue-summary><div class=note><div class=note-content><p><a href=https://www.davidbrin.com/fiction/givingplague.html target=_blank rel=noopener>David Brin</a> 创作的科幻小说。</p></div></div><p>&mldr;&mldr;</p></div><ul class=catalogue-tags><li>#<a href=/tags/%E7%A7%91%E5%B9%BB%E5%B0%8F%E8%AF%B4/>科幻小说</a></li></ul></div><div class=catalogue-item><time datetime="2006-02-04 00:00:00 +0000 UTC" class=catalogue-time>2006年2月4日</time>
<a href=/posts/MSN-multi-clienting-tool-source-code/ class=catalogue-title>MSN 双开工具源代码</a><div class=catalogue-line></div><div class=catalogue-summary><p>网上偶然拾得本人于 2006 年所写的 <strong>MSN Messenger</strong> 双/多开工具的源代码。此即时通讯软件早于 2013 年便已停止服务，而今再看昔日所写代码不甚感慨，遂记录于此，以兹纪念</p></div><ul class=catalogue-tags><li>#<a href=/tags/C/C++/>C/C++</a></li></ul></div></div><div class=pagination><a href=/page/39/ class="left arrow">上一页</a>
<span><sup>40</sup> &frasl; <sub>40</sub></span></div></main><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/highlight.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/scala.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/nim.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/powershell.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/nginx.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/delphi.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/dos.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/haxe.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://unpkg.com/highlightjs-svelte/dist/svelte.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=/js/code.js></script><script>hljs.highlightAll(),hljs.initLineNumbersOnLoad(),hljs.initSelectLines()</script><footer><span>&copy; <time datetime="2024-11-11 10:46:31.605904702 +0000 UTC m=+0.442533863">2024</time> fournoas.com. Powered by <a href=https://gohugo.io>Hugo</a>.</span></footer></body></html>