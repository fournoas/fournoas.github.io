<!doctype html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Unikernel，中文一般翻译为单一内核。是专门为了运行在虚拟机上而打造的系统。维基百科上的解释是： A unikernel is a specialised, single address space machine image constructed by using library operating systems. A developer selects, from a modular stack, the minimal set of libraries which correspond to the OS constructs required for the application to run. These libraries are then compiled with the application and configuration code to build sealed, fixed-purpose images (unikernels) which run directly on a hypervisor or hardware without an intervening OS such as Linux or Windows. 在解释什么是 Unikernel 前，先来了解一下"><title>Unikernel 和 Library OS &#183; 白汤四物</title>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/fontawesome.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/solid.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/regular.min.css crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js crossorigin=anonymous></script><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/rainbow.min.css crossorigin=anonymous referrerpolicy=no-referrer><link href rel=alternate type=application/rss+xml title=白汤四物><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-3GNL63B62Q"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3GNL63B62Q")</script></head><body><nav class=nav><div class=nav-container><h1 class=nav-title><a href=/><img src=/logo.png alt=白汤四物></a></h1><ul><li><a href=/posts/><span>文章</span></a></li><li><a href=/moments/><span>动态</span></a></li><li><a href=/categories/><span>分类</span></a></li><li><a href=/tags/><span>标签</span></a></li><li><a href=/search/><span>搜索</span></a></li><li><a href=/about/><span>关于</span></a></li></ul></div></nav><main data-pagefind-body><div class="page post"><h1 class=post-title data-pagefind-meta=title>Unikernel 和 Library OS</h1><div class=post-line></div><div class=post-info><span>作者</span>
<span data-pagefind-meta=作者>Fournoas
</span><span>于&nbsp;</span><time datetime="2022-06-26 00:00:00 +0000 UTC" data-pagefind-meta=日期>2022年6月26日</time>
<span>发布在&nbsp;</span><ul class=categories><li><a data-pagefind-filter=分类 href=/categories/coding/>Coding</a></li></ul></div><p>Unikernel，中文一般翻译为单一内核。是专门为了运行在虚拟机上而打造的系统。维基百科上的解释是：</p><blockquote><p>A unikernel is a specialised, single address space machine image constructed by using library operating systems. A developer selects, from a modular stack, the minimal set of libraries which correspond to the OS constructs required for the application to run. These libraries are then compiled with the application and configuration code to build sealed, fixed-purpose images (unikernels) which run directly on a hypervisor or hardware without an intervening OS such as Linux or Windows.</p></blockquote><p>在解释什么是 Unikernel 前，先来了解一下虚拟机运行通用操作系统有哪些痛点。</p><figure><img src=/posts/unikernel-and-library-os/windows-architecture.png alt="以 Windows 操作系统为例"><figcaption><p>以 Windows 操作系统为例</p></figcaption></figure><p>首先，通用操作系统的应用程序的代码运行在用户模式下，操作系统内核运行在内核模式下。用户模式下需要通过 syscall 切换到内核模式来调用内核代码。这种模式切换也是相当耗费系统资源的。而且，用户模式和内核模式无法相互访问对方的内存空间的，如果需要交换数据的话，还必须把数据复制到对方的内存空间中。</p><p>其次，通用操作系统需要运行在不同的硬件平台，所以一般会实现硬件抽象层（HAL）来兼容不同的硬件。</p><p>最后，通用操作系统为了满足不同的需求，内置了很多服务和组件。而在虚拟机中的应用往往只是为了执行单一任务，只需要使用到操作系统的部分功能。即便如此，也要引入完整的操作系统功能，有点空耗资源。</p><p>Unikernel 是运行在虚拟机中的单一地址空间的系统映像，不需要 CPU 在用户模式和内核模式之间切换，也没有进程的内存隔离，不需要上下文切换。因此， Unikernel 能节省很多系统开销。此外，虚拟机中的虚拟设备都是统一规格，相当于由 Host OS 实现了 HAL。Unikernel 不需要兼容不同硬件的复杂架构，内核代码会轻量很多。</p><p>Library OS，中文一般翻译为库操作系统，是专门负责打包 Unikernel 映像的操作系统。LibOS 可以检测到应用代码使用了哪些内核功能，在打包映像时对内核进行剪裁，只保留应用程序使用的内核代码。</p><p>由于 Unikernel 映像是单一地址空间，所以无法像通用操作系统一样，通过进程来实现资源隔离。不过解决方案也很简单，如果应用有资源隔离的需求，就打包成不同的映像运行在不同的虚拟机中便可。</p></div><div class=taxonomy data-pagefind-ignore><div class=taxonomy-tags><ul class=tags><li>#<a data-pagefind-filter=标签 href=/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/>操作系统</a></li></ul></div></div><div class=pagination data-pagefind-ignore><a href=/moments/202206/1656387647/ class="left arrow">上一篇</a>
<a href=/moments/202206/1656127603/ class="right arrow">下一篇</a>
<a href=# class=top>返回顶部</a></div></main><script src=/js/page.js></script><script src=/js/main.js></script><footer><span>&copy; <time datetime="2024-07-13 13:26:47.114821758 +0000 UTC m=+0.829133268">2024</time> fournoas.com. Powered by <a href=https://gohugo.io>Hugo</a>.</span></footer></body></html>