<!doctype html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="xdg-open 是 Linux 下的一个命令，可以调用对应的程序来打开目标文件，等同于在文件管理器中双击打开该文件。Ubuntu 用户可以通过执行 sudo apt install xdg-utils -y 来安装 xdg-open 命令，这个命令的用法也很简单：
xdg-open { file | URL }
遗憾的是， Windows 系统并没用提供类似的命令，不过我们可以通过 Windows 自带的 rundll32.exe 命令来实现一个类似功能的脚本。
RunDLL32.exe 用来加载指定的 DLL 文件并调用指定的导出函数。用法如下："><title>用 RunDLL32.exe 命令实现 xdg-open &#183; 白汤四物</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/fontawesome.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/solid.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/regular.min.css crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js crossorigin=anonymous></script><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/rainbow.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css crossorigin=anonymous referrerpolicy=no-referrer><link href rel=alternate type=application/rss+xml title=白汤四物><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-3GNL63B62Q"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3GNL63B62Q")</script></head><body><nav class=nav><div class=nav-container><h1 class=nav-title><a href=/><img src=/logo.png alt=白汤四物></a></h1><ul><li><a href=/posts/><span>文章</span></a></li><li><a href=/moments/><span>动态</span></a></li><li><a href=/categories/><span>分类</span></a></li><li><a href=/tags/><span>标签</span></a></li><li><a href=/search/><span>搜索</span></a></li><li><a href=/about/><span>关于</span></a></li></ul></div></nav><main data-pagefind-body><div class="page post"><h1 class=post-title data-pagefind-meta=title>用 RunDLL32.exe 命令实现 xdg-open</h1><div class=post-line></div><div class=post-info><span>作者</span>
<span data-pagefind-meta=作者>Fournoas
</span><span>写于&nbsp;</span><time datetime="2023-09-07 00:00:00 +0000 UTC" data-pagefind-meta=日期>2023年9月7日</time>
<span>发布在&nbsp;</span><ul class=categories><li><a data-pagefind-filter=分类 href=/categories/using/>Using</a></li></ul></div><p><code>xdg-open</code> 是 Linux 下的一个命令，可以调用对应的程序来打开目标文件，等同于在文件管理器中双击打开该文件。Ubuntu 用户可以通过执行 <code>sudo apt install xdg-utils -y</code> 来安装 <code>xdg-open</code> 命令，这个命令的用法也很简单：</p><pre><code class=language-text>xdg-open { file | URL }</code></pre><p>遗憾的是， Windows 系统并没用提供类似的命令，不过我们可以通过 Windows 自带的 rundll32.exe 命令来实现一个类似功能的脚本。</p><p>RunDLL32.exe 用来加载指定的 DLL 文件并调用指定的导出函数。用法如下：</p><pre><code class=language-text>rundll32 &lt;dll name&gt;,&lt;entry point&gt; &lt;optional arguments&gt;</code></pre><p>其中：</p><ul><li><code>dll name</code> 是 DLL 文件名；</li><li><code>entry point</code> 是导出的函数名称；</li><li><code>optional arguments</code> 是传递给函数的参数。</li></ul><p>能接受 rundll32.exe 调用的 API 函数签名应满足如下形式：</p><pre><span class=code-lang>c&#43;&#43;</span><code class=language-c++>// __stdcall
void CALLBACK EntryPointW(
    HWND hWnd, 
    HINSTANCE hInst, 
    LPWSTR lpszCmdLine, 
    int nCmdShow
);</code></pre><div class=note><div class=note-header><span class=note-title>题外话</span></div><div class=note-content><p>函数签名不一致的 API 也有被调用成功的可能，但是这些 API 并不能正确地接收参数。以 <a href=https://learn.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-shellabouta target=_blank rel=noopener>ShellAboutA</a> 为例，其函数原型为：</p><pre><span class=code-lang>c&#43;&#43;</span><code class=language-c++>INT ShellAboutA(
[in, optional] HWND   hWnd,
[in]           LPCSTR szApp,
[in, optional] LPCSTR szOtherStuff,
[in, optional] HICON  hIcon
);</code></pre><p>当执行 <code>rundll32 shell32.dll,ShellAboutA Other Stuff</code> 命令后，发现关于对话框的标题是 <code>关于“MZ?”</code>，版权信息下会显示 <code>Other Stuff</code> 字样。这是由于 rundll32.exe 将 <code>hInst</code> 当作 <code>szApp</code> 字符串指针传递给了 <code>ShellAboutA</code> 函数，而 <code>hInst</code> 的值就是可执行文件 rundll32.exe 在内存中的加载位置，我们看到的 <code>MZ?</code> 字符串正是 rundll32.exe 的 PE 文件头；而参数 <code>lpszCmdLine</code> 正好对应参数 <code>szOtherStuff</code> 显示在了对话框中。</p></div></div><p>用户在 Windows 资源管理器中双击一个文件后，最终会通过 Windows API <code>ShellExecuteW</code> 来打开文件。这个 API 由 shell32.dll 文件导出，不过由于参数的格式限制， rundll32.exe 并不能直接调用该 API 。所幸 shell32.dll 导出了一系列以 <code>_RunDLL(A/W)</code> 为结尾的 Undocumented API 专门用于被 rundll32.exe 调用：</p><pre><code class=language-text>OpenAs_RunDLL
OpenAs_RunDLLA
OpenAs_RunDLLW
PrintersGetCommand_RunDLL
PrintersGetCommand_RunDLLA
PrintersGetCommand_RunDLLW
SHHelpShortcuts_RunDLL
SHHelpShortcuts_RunDLLA
SHHelpShortcuts_RunDLLW
AppCompat_RunDLLW
Control_RunDLL
Control_RunDLLA
Control_RunDLLAsUserW
Control_RunDLLW
LaunchMSHelp_RunDLLW
Options_RunDLL
Options_RunDLLA
Options_RunDLLW
RunAsNewUser_RunDLLW
ShellExec_RunDLL
ShellExec_RunDLLA
ShellExec_RunDLLW</code></pre><p>其中 <code>ShellExec_RunDLL</code> 正是对应 <code>ShellExecuteW</code> 的版本。用法如下：</p><pre><code class=language-text>rundll32.exe shell32.dll,ShellExec_RunDLL { file }</code></pre><p>然而 <code>ShellExec_RunDLL</code> 并不像 <code>xdg-open</code> 那样支持打开 URL 。经过一番搜索，发现 url.dll 导出的 Undocumented API <code>OpenURL</code> 可以满足要求，且支持被 rundll32.exe 调用：</p><pre><code class=language-text>rundll32.exe url.dll,OpenURL { file | URL }</code></pre><p>创建一个名为 <code>xdg-open.ps1</code> 的脚本文件，内容如下：</p><pre><span class=code-lang>powershell</span><code class=language-powershell>param($file)
rundll32 url.dll,OpenURL $file</code></pre><p>将脚本文件保存在系统 PATH 路径下，就可以在命令行中使用 Windows 版的 <code>xdg-open</code> 命令了。</p><hr><p>附录：常用的 RunDLL32 命令</p><table class=fullwidth><thead><tr><th>描述</th><th>命令</th></tr></thead><tbody><tr><td>关于 Windows</td><td><code>rundll32 shell32.dll,ShellAbout</code></td></tr><tr><td>映射网络驱动器</td><td><code>rundll32 shell32.dll,SHHelpShortcuts_RunDLL Connect</code></td></tr><tr><td>添加打印机</td><td><code>rundll32 shell32.dll,SHHelpShortcuts_RunDLL AddPrinter</code></td></tr><tr><td>打印机文件夹</td><td><code>rundll32 shell32.dll,SHHelpShortcuts_RunDLL PrintersFolder</code></td></tr><tr><td>字体文件夹</td><td><code>rundll32 shell32.dll,SHHelpShortcuts_RunDLL FontsFolder</code></td></tr><tr><td>打开方式</td><td><code>rundll32 shell32.dll,OpenAs_RunDLL { file }</code></td></tr><tr><td>文件资源管理器选项 - 常规</td><td><code>rundll32 shell32.dll,Options_RunDLL 0</code></td></tr><tr><td>任务栏设置</td><td><code>rundll32 shell32.dll,Options_RunDLL 1</code></td></tr><tr><td>文件资源管理器选项 - 搜索</td><td><code>rundll32 shell32.dll,Options_RunDLL 2</code></td></tr><tr><td>开始设置</td><td><code>rundll32 shell32.dll,Options_RunDLL 3</code></td></tr><tr><td>文件资源管理器选项 - 查看</td><td><code>rundll32 shell32.dll,Options_RunDLL 7</code></td></tr><tr><td>打开控制面板</td><td><code>rundll32 Shell32.dll,Control_RunDLL { CPL file },{@appletindex},{tabindex}</code><br><a href=https://help.ivanti.com/res/help/en_US/IWC/10.5/Help/Content/20030.htm target=_blank rel=noopener>更多内容</a></td></tr><tr><td>交换鼠标主按钮</td><td><code>rundll32 user32.dll,SwapMouseButton</code></td></tr><tr><td>锁定计算机</td><td><code>rundll32 user32.dll,LockWorkStation</code></td></tr><tr><td>存储的用户名和密码</td><td><code>rundll32 keymgr.dll,KRShowKeyMgr</code></td></tr><tr><td>Windows To Go 启动选项</td><td><code>rundll32 pwlauncher.dll,ShowPortableWorkspaceLauncherConfigurationUX</code></td></tr><tr><td>添加标准 TCP/IP 打印机端口向导</td><td><code>rundll32 tcpmonui.dll,LocalAddPortUI</code></td></tr><tr><td>休眠</td><td><code>rundll32 powrprof.dll,SetSuspendState</code></td></tr><tr><td>环境变量</td><td><code>rundll32 sysdm.cpl,EditEnvironmentVariables</code></td></tr><tr><td>添加网络位置向导</td><td><code>rundll32 shwebsvc.dll,AddNetPlaceRunDll</code></td></tr><tr><td>设备管理器</td><td><code>rundll32 devmgr.dll DeviceManager_Execute</code></td></tr><tr><td>打印机用户界面</td><td><code>rundll32 printui.dll,PrintUIEntry [options] [@commandfile]</code><br>使用 <code>rundll32 printui.dll,PrintUIEntry /?</code> 查看所有参数</td></tr><tr><td>打开文件或 URL</td><td><code>rundll32 url.dll,OpenURL { file | URL }</code></td></tr><tr><td>打开文件协议</td><td><code>rundll32 url.dll,FileProtocolHandler { file scheme URL }</code><br>参数为 <code>file://</code> 协议的文件 URL</td></tr><tr><td>打开 Internet 快捷方式</td><td><code>rundll32 shdocvw.dll,OpenURL { internet shorcut file }</code><br>打开 <code>*.url</code> 文件</td></tr><tr><td>打开 Internet 快捷方式</td><td><code>rundll32.exe ieframe.dll,OpenURL { internet shorcut file }</code></td></tr><tr><td>打开文件</td><td><code>rundll32 zipfldr.dll,RouteTheCall { file }</code></td></tr><tr><td>下载并打开网络图片</td><td><code>rundll32 shimgvw.dll,ImageView_Fullscreen { image url }</code></td></tr></tbody></table></div><div class=taxonomy data-pagefind-ignore><div class=taxonomy-tags><ul class=tags><li>#<a data-pagefind-filter=标签 href=/tags/Windows/>Windows</a></li></ul></div></div><div class=pagination data-pagefind-ignore><a href=/posts/prajna-paramita-hrdaya-sutra/ class="left arrow">上一篇：<br>般若波罗蜜多心经</a>
<a href=/moments/202309/1693972535/ class="right arrow">下一篇</a>
<a href=# class=top>返回顶部</a></div></main><script src=/js/page.js></script><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/highlight.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/scala.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/nim.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/powershell.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/nginx.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/delphi.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/dos.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/haxe.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://unpkg.com/highlightjs-svelte/dist/svelte.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://unpkg.com/highlightjs-zig/dist/zig.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://unpkg.com/highlightjs-redbol/dist/redbol.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=/js/code.js></script><script>hljs.highlightAll(),hljs.initLineNumbersOnLoad(),hljs.initSelectLines()</script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js crossorigin=anonymous referrerpolicy=no-referrer onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"\\[",right:"\\]",display:!0},{left:"$$",right:"$$",display:!0},{left:"\\(",right:"\\)",display:!1}],throwOnError:!1})})</script><footer><span>&copy; <time datetime="2025-10-31 03:47:31.58191825 +0000 UTC m=+1.187366802">2025</time> fournoas.com. Powered by <a href=https://gohugo.io/>Hugo</a> v0.152.2.</span></footer></body></html>