<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>破解华为光猫（ONT）的设备连接数限制 &middot; 白汤四物</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/rainbow.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/scala.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/nim.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/powershell.min.js crossorigin=anonymous></script><script>hljs.initHighlightingOnLoad();</script><script src=https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js crossorigin=anonymous></script><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link href rel=alternate type=application/rss+xml title=白汤四物><script async src="https://www.googletagmanager.com/gtag/js?id=UA-153840298-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-153840298-1');</script></head><body><nav class=nav><div class=nav-container><h1 class=nav-title><a href=/><img src=/logo.png alt=白汤四物></a></h1><ul><li><a href=/posts/><span>文章</span></a></li><li><a href=/moments/><span>动态</span></a></li><li><a href=/categories/><span>分类</span></a></li><li><a href=/tags/><span>标签</span></a></li><li><a href=/about/><span>关于</span></a></li></ul></div></nav><main><div class=post><h1 class=post-title>破解华为光猫（ONT）的设备连接数限制</h1><div class=post-line></div><div class=post-info><span>作者</span>
Fournoas
<span>于&nbsp;</span><time datetime="2019-06-07 00:00:00 &#43;0000 UTC">2019年6月7日</time>
<span>发布在</span><ul class=categories><li><a href=https://www.fournoas.com/categories/using/>Using</a></li></ul></div><blockquote><p>注意：本文中描述的方法在华为HS8546V（软件版本：V3R017C10S208）上测试通过，但无法保证适用于所有的华为ONT设备。</p></blockquote><h2 id=起因>起因</h2><p>移动宽带的ONT设备型号为HS8546V，在默认配置下限制最大连接10台设备，超出限制的设备虽然可以连接WIFI，但是无法上网。必须破解设备，修改配置文件才能支持更多设备。</p><h2 id=一-打开路由器的telnet功能>一、打开路由器的Telnet功能</h2><p>在浏览器中输入“<a href=http://192.168.1.1 target=_blank>http://192.168.1.1</a> ”，打开路由器的Web设置界面。路由器的IP地址是<code>192.168.1.1</code>，默认设置下，必须使用网线连接的设备才能访问Web管理后台，WIFI连接的设备是无法访问的。使用如下账号登录：</p><pre><code>账号： CMCCAdmin
密码： aDm8H%MdA
</code></pre><p><img src=ill-1.png alt=登录界面></p><p>选择菜单“<code>安全</code>”-“<code>ONT访问控制配置</code>”，勾选“<code>使能LAN侧PC通过TELNET访问设备</code>”，点击“应用”按钮使设置生效。</p><p><img src=ill-2.png alt=打开设备telnet接口></p><p>现在就可以通过telnet命令来访问路由器了。如果你使用windows系统，而且没有安装telnet客户端，可以通过“<code>控制面板</code>”-“<code>启用或关闭windws功能</code>”，勾选“<code>Telnet Client</code>”来进行安装。</p><p><img src=ill-3.png alt=安装telnet客户端></p><h2 id=二-补全shell>二、补全Shell</h2><p>现在虽然打开了设备的telnet接口，但是无法执行任何命令，因为默认配置下，所有命令都是被锁掉的。需要安装补丁来进行开启，这步操作称作“<strong>补全Shell</strong>”。使用这个关键字，可以在网上搜到很多信息，但是不保证这些方法都是可用的。下面介绍的方法根据我的实际操作是可行的，但是不能保证在你的设备上也是可行的。</p><p>破解需要用到以下几个工具，我已经打包上传到github了。下载地址： <a href=https://github.com/tabris17/Crack-Huawei-ONT/releases/ target=_blank>https://github.com/tabris17/Crack-Huawei-ONT/releases/</a></p><p><img src=ill-4.png alt="下载 crack-huawei-ont.zip"></p><p>将下载的压缩包解压后可以找到4个文件：</p><p><img src=ill-5.png alt=破解使用的工具></p><p>其中“<code>hs8546v_shell_sp.bin</code>”是破解补丁；“<code>华为光猫配置文件加解密工具.exe</code>”是用来编码配置文件的工具；“<code>tftpd64.464.zip</code>”中是一个tftp服务器软件，用来向光猫设备传输补丁文件；“<code>ont使能.exe</code>”是用来刷机的工具，但是根据我实际操作，使用该工具刷机无效，最后采用tftp传输的方式，不过这个工具也一并打包了。</p><p>首先，解压缩“<code>tftpd64.464.zip</code>”。运行“<code>tftpd64.exe</code>”：</p><p><img src=ill-6.png alt="运行 Tftp64"></p><p>在软件界面里，设置“<code>Current Directory</code>”为“<code>hs8546v_shell_sp.bin</code>”文件所在的路径；设置“<code>Server interfaces</code>”为连接路由器的网卡地址，此处为 <code>192.168.1.142</code>。具体配置信息请根据运行环境自行设置。这个软件的作用是在当前主机上运行一个tftp服务，给路由器访问。之后上传补丁文件和配置文件时都需要用到。</p><p>接着，运行 telnet 连接路由器：</p><p><img src=ill-7.png alt=运行telnet连接路由器></p><p>使用如下账户登录：</p><pre><code>Login: root
Password: adminHW
</code></pre><p>在命令行提示下执行如下命令进行刷机操作：</p><pre><code>su
shell
load pack by tftp svrip 192.168.1.142 remotefile hs8546v_shell_sp.bin
</code></pre><p><img src=ill-8.png alt=运行命令刷机></p><p>请将命令中“<code>192.168.1.142</code>”修改为你的主机地址。当看到返回消息：</p><pre><code>Software Operation Successful!RetCode=0x0!
</code></pre><p>表明刷机成功。重启路由器后就可以使用解锁的命令了。</p><h2 id=三-修改配置>三、修改配置</h2><p>由于配置文件是经过编码的，所以无法在路由器上直接编辑，需要先将配置文件下载到本地主机。用telnet连接路由器并运行以下命令：</p><pre><code>su
shell
tftp -l /mnt/jffs2/hw_ctree.xml -p 192.168.1.142
</code></pre><p>执行成功后，可以在tftpd64的”<code>Current Directory</code>“下找到”<code>hw_ctree.xml</code>“文件。运行”<code>华为光猫配置文件加解密工具.exe</code>“进行解码：</p><p><img src=ill-9.png alt=点击”解密“按钮></p><p>用7-zip或其他压缩软件打开刚才生成的”<code>hw_ctree.xml.gz</code>“文件，获得解码后的”<code>hw_ctree.xml</code>“配置文件：</p><p><img src=ill-10.png alt=获得解码后的配置文件></p><p>用文本编辑器打开解码后的”<code>hw_ctree.xml</code>“，找到”<code>TotalTerminalNumber</code>“，可以看到默认值是10。将该值改成100（也可以修改成更大的数字）后保存。</p><p><img src=ill-11.png alt=修改配置文件中的最大连接设备数></p><p>用7-zip或其他压缩软件将修改后的”<code>hw_ctree.xml</code>“压缩成gzip格式的压缩包：</p><p><img src=ill-12.png alt='压缩"hw_ctree.xml“文件'></p><p>并将生成的”<code>hw_ctree.gz</code>“文件用”<code>华为光猫配置文件加解密工具.exe</code>“工具进行编码：</p><p><img src=ill-13.png alt=点击”加密“按钮></p><p>最后将生成的新配置文件”<code>hw_ctree.xml</code>“上传到路由器覆盖原来的配置文件。运行命令：</p><pre><code>su
shell
tftp -l /mnt/jffs2/hw_ctree.xml -r hw_ctree.xml -g 192.168.1.142
</code></pre><p>重启路由器后使配置生效。自此，你的路由器就已经可以连接100个设备了。</p></div><div class=taxonomy><div class=taxonomy-tags><ul class=tags><li>#<a href=https://www.fournoas.com/tags/%E7%BD%91%E7%BB%9C/>网络</a></li></ul></div></div><div class=pagination><a href=/moments/201905/1558765535/ class="left arrow">上一篇</a>
<a href=/posts/a-free-rent-phone-card-of-US-telecom-carrier/ class="right arrow">下一篇：<br>0月租美国实体电话卡</a>
<a href=# class=top>返回顶部</a></div></main><footer><span>&copy; <time datetime="2022-02-16 09:25:41.139750239 &#43;0000 UTC m=&#43;0.438388881">2022</time> fournoas.com. Powered by <a href=https://gohugo.io>Hugo</a> and <a href=https://github.com/EmielH/tale-hugo>Tale</a> theme.</span></footer><script src=/js/main.js></script></body></html>